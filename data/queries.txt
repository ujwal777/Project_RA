LOAD EMPLOYEE
LOAD WORKS_ON

TEMP <- SELECT Salary >= 30000 FROM EMPLOYEE
Q1 <- PROJECT Ssn , Salary FROM TEMP

TEMP1 <- CROSS EMPLOYEE EMPLOYEE
TEMP2 <- SELECT EMPLOYEE1_Super_ssn == EMPLOYEE2_Ssn FROM TEMP1
TEMP3 <- SELECT EMPLOYEE1_Bdate == EMPLOYEE2_Bdate FROM TEMP2
Q2 <-  PROJECT EMPLOYEE1_Ssn , EMPLOYEE2_Ssn , EMPLOYEE1_Bdate FROM TEMP3
RENAME EMPLOYEE1_Ssn TO Ssn FROM Q2
RENAME EMPLOYEE2_Ssn TO Super_ssn FROM Q2
RENAME EMPLOYEE1_Bdate TO Bdate FROM Q2

TEMP5 <- CROSS EMPLOYEE WORKS_ON
TEMP6 <- SELECT Ssn == Essn FROM TEMP5
TEMP7 <- CROSS TEMP6 TEMP6
TEMP8 <- SELECT TEMP61_Pno == TEMP62_Pno FROM TEMP7
TEMP9 <- SELECT TEMP61_Sex != TEMP62_Sex FROM TEMP8
TEMP11 <- PROJECT TEMP61_Ssn , TEMP62_Ssn , TEMP62_Pno FROM TEMP9
TEMP12 <- SELECT TEMP61_Ssn >  TEMP62_Ssn FROM TEMP11
Q3 <- PROJECT TEMP62_Pno FROM TEMP12
RENAME TEMP62_Pno TO Pno FROM Q3

TEMP13 <- CROSS EMPLOYEE WORKS_ON
TEMP14 <- SELECT Ssn == Essn FROM TEMP13
TEMP15 <- CROSS TEMP14 WORKS_ON
TEMP16 <- SELECT TEMP14_Pno == WORKS_ON_Pno FROM TEMP15
TEMP17 <- SELECT Super_ssn == WORKS_ON_Essn FROM TEMP16
Q4 <- PROJECT Ssn , Super_ssn , TEMP14_Pno FROM TEMP17
RENAME TEMP14_Pno TO Pno FROM Q4

EXPORT Q1
EXPORT Q2
EXPORT Q3
EXPORT Q4
QUIT
